(()=>{"use strict";class t{constructor(t){this.column=t,this.onCancelButton=this.onCancelButton.bind(this),this.onAddCardConfirmButton=this.onAddCardConfirmButton.bind(this)}renderBlock(){const t=document.createElement("div");t.classList.add("add-card-wrapper");const e=document.createElement("textarea");e.placeholder="Enter a title for this card...",e.classList.add("title-input-field");const n=document.createElement("a");n.classList.add("add-card-confirm-button"),n.textContent="Add card";const o=document.createElement("a");return o.classList.add("cancel-button"),o.textContent="✖",t.append(e,n,o),o.addEventListener("click",this.onCancelButton),n.addEventListener("click",this.onAddCardConfirmButton),t}onCancelButton(t){const e=t.target.closest(".add-card-wrapper"),n=t.target.closest(".column-container");e.remove();n.querySelector(".addcard-button").style.display="block"}onAddCardConfirmButton(t){const e=t.target.previousElementSibling.value.trim();e&&(this.column.addCard(e),this.onCancelButton(t))}}class e{constructor(t,e){this.text=t,this.column=e,this.removeCard=this.removeCard.bind(this)}renderCard(){const t=document.createElement("pre");t.classList.add("card"),t.textContent=this.text;const e=document.createElement("a");return e.classList.add("remove-button"),e.textContent="✖",t.appendChild(e),e.addEventListener("click",this.removeCard),t}removeCard(t){t.target.closest("pre").remove(),this.column.removeCard(this)}}const n="appState";function o(t){localStorage.setItem(n,JSON.stringify(t))}function r(){return JSON.parse(localStorage.getItem(n))||{}}class d{constructor(t){this.title=t,this.cards=[],this.cardsWrapper=null,this.openNewCardBlock=this.openNewCardBlock.bind(this)}renderColumn(){const t=document.createElement("div");t.classList.add("column-container");const e=document.createElement("p");e.classList.add("title"),e.textContent=this.title;const n=document.createElement("div");n.classList.add("cards-wrapper"),n.id=this.title,this.cardsWrapper=n;const o=document.createElement("a");return o.classList.add("addcard-button"),o.textContent="+ Add another card",t.appendChild(e),t.appendChild(n),t.appendChild(o),o.addEventListener("click",this.openNewCardBlock),t}openNewCardBlock(e){const n=new t(this).renderBlock(),o=e.target.closest("div"),r=o.querySelector(".addcard-button");o.insertBefore(n,r),r.style.display="none"}addCard(t){const n=new e(t,this),o=n.renderCard();this.cards.push(n),this.cardsWrapper.appendChild(o),this.saveToStorage()}removeCard(t){this.cards=this.cards.filter((e=>e!==t)),this.saveToStorage()}saveToStorage(){const t=r();t[this.title]=this.cards.map((t=>t.text)),o(t)}}function s(t,e,n,o){t.classList.contains("background")||(e.target.style.display="none");let r=document.elementFromPoint(e.clientX,e.clientY);if(!r)return;r.classList.contains("cards-wrapper")&&(r=document.elementFromPoint(e.clientX,e.clientY+15));let d=r.closest(".cards-wrapper");const s=r.closest(".column-container");if(!s)return void n.insertBefore(t,o);if(!d)return d=s.querySelector(".cards-wrapper"),void d.appendChild(t);const c=r.getBoundingClientRect();let a=c.top+c.height/2;r!==t&&null!==r&&(e.clientY>a?d.insertBefore(t,r.nextSibling):d.insertBefore(t,r))}(new class{renderContainer(){const t=document.createElement("div");t.classList.add("container"),document.body.appendChild(t);const e=r();window.columnsRef={},["TODO","IN PROGRESS","DONE"].forEach((n=>{const o=new d(n),r=o.renderColumn();t.appendChild(r),window.columnsRef[n]=o,e[n]&&e[n].forEach((t=>o.addCard(t)))}))}}).renderContainer(),function(){const t=document.querySelector(".container");let e,n,r=null,d=0,c=0;const a=t=>{r.style.position="absolute",document.body.appendChild(r),r.style.top=t.clientY-d+"px",r.style.left=t.clientX-c+"px",function(t,e,n,o){const r=document.querySelector(".background");r&&r.remove();const d=document.createElement("div");d.classList.add("background");const c=t.getBoundingClientRect().height;d.style.height=c+"px",t.style.display="none",s(d,e,n,o),t.style.display=""}(r,t,e,n)},i=t=>{s(r,t,e,n),document.documentElement.removeEventListener("mousemove",a),document.documentElement.removeEventListener("mouseup",i),r.classList.remove("dragging"),r.style="";const o=document.querySelector(".background");o&&o.remove(),l()},l=()=>{const t=document.querySelectorAll(".cards-wrapper"),e={};t.forEach((t=>{const n=t.id,o=Array.from(t.querySelectorAll(".card")).map((t=>Array.from(t.childNodes).filter((t=>t.nodeType===Node.TEXT_NODE)).map((t=>t.textContent.trim())).join("")));e[n]=o})),o(e)};t.addEventListener("mousedown",(t=>{if(!t.target.classList.contains("card"))return;t.preventDefault(),r=t.target,e=r.parentElement,n=r.nextSibling;const o=r.getBoundingClientRect();c=t.clientX-o.left,d=t.clientY-o.top,r.style.width=`${o.width}px`,r.classList.add("dragging"),document.documentElement.addEventListener("mousemove",a),document.documentElement.addEventListener("mouseup",i)}))}()})();